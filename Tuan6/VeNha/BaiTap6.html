<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Game Di·ªát R·ªìng - Giao di·ªán tr·∫≠n ƒë·∫•u</title>
<style>
  :root{--bg:#0f1720;--panel:#0b1220;--accent:#ff6b6b;--accent2:#48cae4;--hp:#2ecc71}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial; background:linear-gradient(180deg,#071020 0%, #0f1720 100%); color:#e6eef6}
  .wrap{max-width:980px;margin:18px auto;padding:18px}
  header{display:flex;align-items:center;justify-content:space-between}
  h1{font-size:20px;margin:0}

  .arena{display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:14px}
  .board{background:linear-gradient(180deg,rgba(255,255,255,0.02), rgba(0,0,0,0.05));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}

  /* characters area */
  .fighters{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .char{width:45%;display:flex;flex-direction:column;align-items:center}
  .sprite-box{width:220px;height:220px;display:flex;align-items:center;justify-content:center}
  .sprite{width:140px;height:140px;display:block;transform-origin:center;}

  /* simple SVG look */
  .hero svg .body{fill:var(--hp)}
  .dragon svg .body{fill:var(--accent)}

  /* health bars */
  .hp-row{width:100%;display:flex;align-items:center;gap:8px}
  .hp-info{flex:1}
  .hp-num{min-width:64px;text-align:right;font-weight:600}
  .bar-outer{background:#122029;border-radius:8px;height:18px;overflow:hidden}
  .bar-inner{height:100%;width:100%;background:linear-gradient(90deg,#2ecc71,#1fa37a);transition:width .4s}
  .bar-inner.dragon{background:linear-gradient(90deg,#ff6b6b,#ff3b3b)}

  /* controls and log */
  .controls{display:flex;flex-direction:column;gap:10px}
  .btn-row{display:flex;gap:8px}
  .btn{flex:1;padding:10px;border-radius:8px;border:none;font-weight:700;cursor:pointer}
  .btn.attack{background:linear-gradient(180deg,#ff9f43,#ff6b6b);color:#111}
  .btn.skill{background:linear-gradient(180deg,#48cae4,#2b9ccf);color:#032}
  .btn.disabled{opacity:.45;cursor:not-allowed}

  .log{background:#071822;border-radius:8px;padding:10px;height:330px;overflow:auto;font-size:13px}
  .log p{margin:6px 0;padding:6px;border-radius:6px}
  .log .hero{background:rgba(46,204,113,0.08);color:#9df3b0}
  .log .dragon{background:rgba(255,107,107,0.06);color:#ffb4b4}
  .log .info{background:rgba(255,255,255,0.02)}

  /* animations */
  @keyframes attackMove{0%{transform:translateX(0)}50%{transform:translateX(18px)}100%{transform:translateX(0)}}
  @keyframes dragonAttack{0%{transform:translateX(0)}50%{transform:translateX(-18px)}100%{transform:translateX(0)}}
  @keyframes hitShake{0%{transform:translateX(0)}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)}}
  @keyframes dodgeSpin{0%{transform:rotate(0) translateY(0)}50%{transform:rotate(10deg) translateY(-8px)}100%{transform:rotate(0) translateY(0)}}

  .attackAnim{animation:attackMove .36s ease}
  .dragonAttackAnim{animation:dragonAttack .36s ease}
  .hitAnim{animation:hitShake .28s ease}
  .dodgeAnim{animation:dodgeSpin .4s ease}

  /* small meta */
  footer{margin-top:12px;color:#9fb4c7;font-size:13px}
  .stats{display:flex;gap:10px;flex-wrap:wrap}
  .stat{background:#071b22;padding:6px 10px;border-radius:8px}

  /* responsive */
  @media(max-width:880px){.arena{grid-template-columns:1fr;}.sprite-box{height:160px}} 
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>üõ°Ô∏è Di·ªát R·ªìng ‚Äî Giao di·ªán tr·∫≠n ƒë·∫•u</h1>
    <div class="stats">
      <div class="stat">M·ª•c ti√™u: Gi·∫£m HP R·ªìng v·ªÅ 0</div>
      <div class="stat">Th·∫Øng: LEVEL UP ‚Ä¢ Thua: Th·ª≠ l·∫°i</div>
    </div>
  </header>

  <div class="arena">
    <div class="board">
      <div class="fighters">
        <!-- HERO -->
        <div class="char">
          <div style="display:flex;align-items:center;gap:12px;width:100%">
            <div style="flex:1;text-align:left">
              <strong>Anh H√πng</strong>
            </div>
            <div class="hp-num" id="hero-num">300 / 300</div>
          </div>
          <div class="hp-row" style="margin-top:8px">
            <div class="hp-info">
              <div class="bar-outer"><div id="heroBar" class="bar-inner" style="width:100%"></div></div>
            </div>
          </div>

          <div class="sprite-box">
            <div id="heroSprite" class="sprite hero">
              <!-- simple SVG hero -->
              <svg viewBox="0 0 120 120" width="120" height="120" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <circle class="body" cx="60" cy="34" r="18" />
                  <rect class="body" x="42" y="52" width="36" height="36" rx="8" />
                  <rect x="18" y="84" width="24" height="8" rx="3" fill="#222" />
                  <rect x="78" y="84" width="24" height="8" rx="3" fill="#222" />
                  <path d="M38 58 L20 40" stroke="#fff" stroke-width="3" stroke-linecap="round" fill="none" />
                </g>
              </svg>
            </div>
          </div>
        </div>

        <!-- DRAGON -->
        <div class="char">
          <div style="display:flex;align-items:center;gap:12px;width:100%">
            <div style="flex:1;text-align:left"><strong>R·ªìng</strong></div>
            <div class="hp-num" id="dragon-num">500 / 500</div>
          </div>

          <div class="hp-row" style="margin-top:8px">
            <div class="hp-info">
              <div class="bar-outer"><div id="dragonBar" class="bar-inner dragon" style="width:100%"></div></div>
            </div>
          </div>

          <div class="sprite-box">
            <div id="dragonSprite" class="sprite dragon">
              <!-- simple SVG dragon -->
              <svg viewBox="0 0 120 120" width="120" height="120" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <ellipse class="body" cx="70" cy="42" rx="30" ry="20" />
                  <rect class="body" x="48" y="56" width="44" height="34" rx="10" />
                  <path d="M28 66 q20 -12 40 -8" fill="none" stroke="#111" stroke-width="2" />
                  <circle cx="86" cy="36" r="3" fill="#111" />
                  <path d="M92 48 q12 6 16 18" stroke="#111" stroke-width="3" fill="none" />
                </g>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- controls below characters -->
      <div style="margin-top:10px;display:flex;gap:12px;align-items:flex-start">
        <div style="flex:1">
          <div class="controls">
            <div class="btn-row">
              <button id="attackBtn" class="btn attack">‚öî T·∫•n C√¥ng</button>
              <button id="skillBtn" class="btn skill">üî• Kƒ© NƒÉng (Power Strike)</button>
            </div>

            <div style="display:flex;gap:8px;margin-top:6px;align-items:center">
              <div style="font-size:13px;color:#9fb4c7">Cooldown:</div>
              <div id="skillCooldown" style="font-weight:700">S·∫µn s√†ng</div>
            </div>

            <div style="margin-top:10px;color:#9fb4c7;font-size:13px">Ghi ch√∫: Nh·∫•n T·∫•n C√¥ng ƒë·ªÉ th·ª±c hi·ªán l∆∞·ª£t c·ªßa Anh H√πng. R·ªìng s·∫Ω ph·∫£n c√¥ng ngay sau ƒë√≥.</div>
          </div>
        </div>

        <aside style="width:320px">
          <div style="margin-bottom:8px;color:#9fb4c7;font-size:13px">L·ªãch s·ª≠ ƒë√≤n ƒë√°nh</div>
          <div id="logBox" class="log">
            <p class="info">Tr·∫≠n ƒë·∫•u b·∫Øt ƒë·∫ßu. Chu·∫©n b·ªã chi·∫øn ƒë·∫•u!</p>
          </div>
        </aside>
      </div>
    </div>

    <!-- side panel for stats & controls -->
    <div class="board">
      <h3>Th√¥ng tin tr·∫≠n ƒë·∫•u</h3>
      <div style="margin-top:8px;display:flex;flex-direction:column;gap:8px">
        <div><strong>Anh H√πng</strong></div>
        <div>STR: <span id="s_strength">30</span> ‚Ä¢ AGI: <span id="s_agility">20</span> ‚Ä¢ INT: <span id="s_intel">30</span></div>
        <div style="margin-top:10px"><strong>R·ªìng</strong></div>
        <div>STR: <span id="d_strength">25</span> ‚Ä¢ AGI: <span id="d_agility">10</span> ‚Ä¢ INT: <span id="d_intel">20</span></div>

        <hr style="border:none;border-top:1px solid rgba(255,255,255,0.04)">
        <div style="font-size:13px;color:#9fb4c7">C√°c h√†nh ƒë·ªông s·∫µn c√≥</div>
        <ul style="padding-left:18px;margin:6px 0 0 0;font-size:13px;color:#cfe6f7">
          <li>T·∫•n C√¥ng: s√°t th∆∞∆°ng = STR</li>
          <li>Kƒ© NƒÉng Power Strike: s√°t th∆∞∆°ng = STR √ó 1.5, cooldown 3 l∆∞·ª£t</li>
          <li>N√©: x√°c su·∫•t = AGI%</li>
          <li>Ch√≠ m·∫°ng: x·∫£y ra khi random > INT ‚Üí g√¢y th√™m 200% s√°t th∆∞∆°ng (t·ªïng √ó3)</li>
        </ul>
      </div>
    </div>
  </div>

  <footer>
    G·ª£i √Ω: Mu·ªën th√™m ho·∫°t ·∫£nh ph·ª©c t·∫°p h∆°n (h√¨nh PNG, sprite-sheet ho·∫∑c √¢m thanh) m√¨nh s·∫Ω b·ªï sung.
  </footer>
</div>

<script>
// --- GAME STATE ---
let maxHero = 300, maxDragon = 500;
let health = 300, strength = 30, agility = 20, intel = 30;
let dragonHealth = 500, dragonStr = 25, dragonAgi = 10, dragonInt = 20;
let gameOver = false;

// skill cooldown (in turns)
let skillCooldown = 0, SKILL_CD = 3;

// elements
const heroBar = document.getElementById('heroBar');
const dragonBar = document.getElementById('dragonBar');
const heroNum = document.getElementById('hero-num');
const dragonNum = document.getElementById('dragon-num');
const logBox = document.getElementById('logBox');
const heroSprite = document.getElementById('heroSprite');
const dragonSprite = document.getElementById('dragonSprite');
const attackBtn = document.getElementById('attackBtn');
const skillBtn = document.getElementById('skillBtn');
const cdText = document.getElementById('skillCooldown');

// update UI function
function updateUI(){
  heroBar.style.width = Math.max(0,(health / maxHero * 100)) + '%';
  dragonBar.style.width = Math.max(0,(dragonHealth / maxDragon * 100)) + '%';
  heroNum.textContent = Math.max(0,health) + ' / ' + maxHero;
  dragonNum.textContent = Math.max(0,dragonHealth) + ' / ' + maxDragon;
  cdText.textContent = skillCooldown > 0 ? (skillCooldown + ' l∆∞·ª£t') : 'S·∫µn s√†ng';
  if(skillCooldown > 0) skillBtn.classList.add('disabled'); else skillBtn.classList.remove('disabled');
}

function writeLog(text, cls='info'){
  const p = document.createElement('p');
  p.className = cls;
  p.textContent = `[${new Date().toLocaleTimeString()}] ` + text;
  logBox.appendChild(p);
  logBox.scrollTop = logBox.scrollHeight;
}

function playAnim(target, cls){
  target.classList.remove(cls);
  // trigger reflow to restart animation
  void target.offsetWidth;
  target.classList.add(cls);
  setTimeout(()=> target.classList.remove(cls), 600);
}

// random helper
function randPercent(){ return Math.random() * 100; }

// resolve a single turn where hero acts then dragon
function heroTurn(useSkill=false){
  if(gameOver) return;

  // HERO ATTACK
  const dragonDodged = randPercent() < dragonAgi;
  if(dragonDodged){
    writeLog('Anh H√πng t·∫•n c√¥ng nh∆∞ng R·ªìng n√© ƒë∆∞·ª£c!', 'dragon');
    playAnim(dragonSprite, 'dodgeAnim');
  } else {
    let dmg = Math.floor(strength * (useSkill ? 1.5 : 1));
    const crit = randPercent() > intel; // theo ƒë·ªÅ b√†i
    if(crit){ dmg *= 3; writeLog(`CH√ç M·∫†NG! Anh H√πng g√¢y ${dmg} s√°t th∆∞∆°ng!`, 'hero'); }
    else writeLog(`Anh H√πng g√¢y ${dmg} s√°t th∆∞∆°ng.`, 'hero');

    dragonHealth -= dmg;
    playAnim(dragonSprite, 'hitAnim');
  }

  updateUI();
  if(dragonHealth <= 0){
    writeLog('BATTLE WON! D≈©ng sƒ© di·ªát R·ªìng ‚Äî LEVEL UP!', 'hero');
    gameOver = true; return;
  }

  // reduce cooldown after hero action
  if(skillCooldown>0) skillCooldown--;

  // DRAGON TURN (counter-attack)
  setTimeout(()=>{
    if(gameOver) return;

    const heroDodged = randPercent() < agility;
    if(heroDodged){
      writeLog('R·ªìng t·∫•n c√¥ng nh∆∞ng Anh H√πng n√© ƒë∆∞·ª£c!', 'hero');
      playAnim(heroSprite, 'dodgeAnim');
    } else {
      let dmg2 = dragonStr;
      const dcrit = randPercent() > dragonInt;
      if(dcrit){ dmg2 *= 3; writeLog(`CH√ç M·∫†NG! R·ªìng g√¢y ${dmg2} s√°t th∆∞∆°ng!`, 'dragon'); }
      else writeLog(`R·ªìng g√¢y ${dmg2} s√°t th∆∞∆°ng.`, 'dragon');

      health -= dmg2;
      playAnim(heroSprite, 'hitAnim');
    }

    updateUI();
    if(health <= 0){
      writeLog('TH·∫§T B·∫†I! Anh H√πng b·ªã R·ªìng ti√™u di·ªát.', 'dragon');
      gameOver = true; return;
    }

  }, 420); // small delay so player sees hero attack animation
}

// button handlers
attackBtn.addEventListener('click', ()=>{ if(gameOver) return; heroTurn(false); });
skillBtn.addEventListener('click', ()=>{
  if(gameOver) return;
  if(skillCooldown>0) { writeLog('Kƒ© nƒÉng ƒëang c√≤n cooldown!', 'info'); return; }
  // use skill
  writeLog('Anh H√πng s·ª≠ d·ª•ng Kƒ© NƒÉng: Power Strike!', 'hero');
  skillCooldown = SKILL_CD;
  heroTurn(true);
});

// initial UI
updateUI();

// expose function to reset (optional)
window.resetMatch = function(){
  health = maxHero; dragonHealth = maxDragon; gameOver = false; skillCooldown = 0; logBox.innerHTML = '<p class="info">Tr·∫≠n ƒë·∫•u ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t l·∫°i.</p>';
  updateUI();
}
</script>
</body>
</html>

